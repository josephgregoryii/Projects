use db_site;


CREATE TABLE Users (
    user_id int NOT NULL PRIMARY KEY AUTO_INCREMENT,
    email varchar(255),
    passwd varchar(255),
    traits varchar(255),
);

CREATE TABLE Demographics (
    user_id int NOT NULL PRIMARY KEY AUTO_INCREMENT,
    full_name varchar(255),
    birthdate varchar(255),
    race varchar(255),
    ethnicity varchar(255),
    sex varchar(255), 
    gender varchar(255),
    height int,
    weight int,
    orientation varchar(255),
    marital_status varchar(255),
    num_children int,
    education_level varchar(255),
    employment_status varchar(255),
    employment_field varchar(255),
    annual_income int,
    parental_income int,
    ideology varchar(255),
    smoking_status int,
    drinks_per_week int,
    weed_per_week int,
    substance_use varchar(255),
    dieting_status int,
    num_partners int,
    safe_sex int,
	credit int,
    CONSTRAINT fk_Users
    FOREIGN KEY (user_id)
    REFERENCES Users(user_id)
		ON UPDATE CASCADE
        ON DELETE CASCADE
);

CREATE TABLE Personality_survey (
    user_id int,
    trait_id int,
    trait_affinity int,
    certainty int,
    importance int,
    ranking int,
    PRIMARY KEY (user_id, trait_id),
    CONSTRAINT fk1_Users
    FOREIGN KEY (user_id)
    REFERENCES Users(user_id)
		ON UPDATE CASCADE
        ON DELETE CASCADE,
	CONSTRAINT fk_Traits
    FOREIGN KEY (trait_id)
    REFERENCES Traits(trait_id)
		ON UPDATE CASCADE
        ON DELETE CASCADE
);

CREATE TABLE Traits (
    trait_id int NOT NULL PRIMARY KEY AUTO_INCREMENT,
    trait_name varchar(255),
    trait_group varchar(255)
);

CREATE TABLE Feedback (
    user_id int,
    trait_id int,
    num_ratings int,
    avg_rating float,
    PRIMARY KEY (user_id, trait_id),
    CONSTRAINT fk2_Users
    FOREIGN KEY (user_id)
    REFERENCES Users(user_id)
		ON UPDATE CASCADE
        ON DELETE CASCADE,
	CONSTRAINT fk1_Traits
    FOREIGN KEY (trait_id)
    REFERENCES Traits(trait_id)
		ON UPDATE CASCADE
        ON DELETE CASCADE
);
